{"version":3,"sources":["../src/iconpicker.js"],"names":["iconpickermodal","init","iconpickerdiv","iconpickerselector","ICON_SET","forEach","v","i","index","clickSet","inputs","Array","from","document","querySelectorAll","input","setAttribute","insertAdjacentHTML","id","value","iconpickers","picker","addEventListener","show","querySelector","getAttribute","highlightselected","Templates","renderForPromise","icons","then","html","require","$","ModalFactory","trigger","create","title","body","footer","done","modal","getRoot","on","search","icon","includes","iconclick","catch","ex","getElementsByClassName","iconclass","getElementById","icondiv","classList","remove","add","event","target","nodeName","parentNode","innerHTML","hide"],"mappings":"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","sourcesContent":["import { exception as displayException } from 'core/notification';\nimport Templates from 'core/templates';\nimport ICON_SET from 'block_floatingbutton/iconset';\n\nvar iconpickermodal;\n\nexport const init = (iconpickerdiv, iconpickerselector) => {\n    ICON_SET.forEach(function (v, i) {\n        v.index = i;\n    });\n\n    var clickSet = false;\n\n    // Make inputs invisible and add button for iconpicker\n    let inputs = Array.from(document.querySelectorAll('.mbs-floatingicon-input input'));\n    inputs.forEach(function (input) {\n        input.setAttribute('style', 'display:none;');\n        input.insertAdjacentHTML(\n            'afterend',\n            '<button class=\"mbs-floatingicons-iconpicker\" type=\"button\" id=\"' + input.id +\n            '_button\" data-icon-input=\"' + input.id + '\"><i class=\"' + input.value + '\"></i></button>'\n        );\n    });\n\n    let iconpickers = Array.from(document.querySelectorAll(iconpickerselector));\n    iconpickers.forEach(function (picker) {\n        picker.addEventListener('click', function () {\n            iconpickermodal.show();\n            document.querySelector('.mbs-iconpicker').setAttribute('data-iconpicker', picker.id);\n            document.querySelector('.mbs-iconpicker').setAttribute('data-icon-input', picker.getAttribute('data-icon-input'));\n            highlightselected();\n        });\n    });\n\n    Templates.renderForPromise('block_floatingbutton/iconpicker', { icons: ICON_SET })\n        .then(({ html}) => {\n            require(['jquery', 'core/modal_factory'], function ($, ModalFactory) {\n                var trigger = $('#create-modal');\n                ModalFactory.create({\n                    title: 'Icon picker',\n                    body: html,\n                    footer: '',\n                }, trigger)\n                    .done(function (modal) {\n                        iconpickermodal = modal;\n                        modal.getRoot().on('modal:shown', function () {\n                            if (!clickSet) {\n                                let search = document.querySelector('#mbs-iconpicker-search');\n                                search.addEventListener('input', function() {\n                                    let icons = Array.from(document.querySelectorAll('.mbs-iconpicker-icon'));\n                                    icons.forEach(function (icon) {\n                                        if(\n                                            icon.getAttribute('data-search').includes(search.value)\n                                        ) {\n                                            icon.setAttribute('style', '');\n                                        } else {\n                                            icon.setAttribute('style', 'display: none;');\n                                        }\n                                    });\n                                });\n                                let icons = Array.from(document.querySelectorAll('.mbs-iconpicker-icon'));\n                                icons.forEach(function (icon) {\n                                    icon.addEventListener('click', iconclick);\n                                });\n                                clickSet = true;\n                            }\n                        });\n                    });\n            });\n\n            return true;\n        }).catch(ex => displayException(ex));\n};\n/**\n * Adds class \"highlight\" to currently selected icon.\n */\nfunction highlightselected() {\n    let icons = Array.from(document.getElementsByClassName('mbs-iconpicker-icon'));\n    let input = document.querySelector('.mbs-iconpicker').getAttribute('data-icon-input');\n    if (!(input === null)) {\n        let iconclass = document.getElementById(input).getAttribute('value');\n        icons.forEach(function (icondiv) {\n            icondiv.classList.remove('highlight');\n            if (icondiv.querySelector('i').classList == iconclass) {\n                icondiv.classList.add('highlight');\n            }\n        });\n    }\n}\n\n/**\n * Function called when user clicks on an icon\n * @param {*} event\n */\nfunction iconclick (event) {\n    let id = document.querySelector('.mbs-iconpicker').getAttribute('data-iconpicker');\n    let input = document.querySelector('.mbs-iconpicker').getAttribute('data-icon-input');\n    if (id) {\n        let icondiv = event.target;\n        if (event.target.nodeName != 'DIV') {\n            icondiv = event.target.parentNode;\n        }\n        let iconclass = document.querySelector('#' + icondiv.id + ' i').classList;\n        document.getElementById(id).innerHTML = '<i class=\"' + iconclass + '\"></i>';\n        document.getElementById(input).setAttribute('value', iconclass);\n    }\n    highlightselected();\n    iconpickermodal.hide();\n}"],"file":"iconpicker.min.js"}