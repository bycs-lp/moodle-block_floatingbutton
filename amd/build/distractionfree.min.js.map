{"version":3,"file":"distractionfree.min.js","sources":["../src/distractionfree.js"],"sourcesContent":["// This file is part of Moodle - http://moodle.org/\n//\n// Moodle is free software: you can redistribute it and/or modify\n// it under the terms of the GNU General Public License as published by\n// the Free Software Foundation, either version 3 of the License, or\n// (at your option) any later version.\n//\n// Moodle is distributed in the hope that it will be useful,\n// but WITHOUT ANY WARRANTY; without even the implied warranty of\n// MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n// GNU General Public License for more details.\n//\n// You should have received a copy of the GNU General Public License\n// along with Moodle.  If not, see <http://www.gnu.org/licenses/>.\n\n/**\n * Toggles distraction-free mode.\n *\n * @module     block_floatingbutton/distractionfree\n * @copyright  2025 ISB Bayern\n * @author     Stefan Hanauska <stefan.hanauska@csg-in.de>\n * @license    http://www.gnu.org/copyleft/gpl.html GNU GPL v3 or later\n */\n\nimport * as Storage from 'core/sessionstorage';\n\n/**\n * Initializes the distraction-free mode toggle button.\n *\n * @param {string} toggleButtonId - The ID of the toggle button element.\n * @param {Array} distractionSelectors - An array of CSS selectors for distractions to hide.\n * @param {Array} nopaddingSelectors - An array of CSS selectors for elements to remove padding / margin from.\n * @param {boolean} closedrawers - Whether to close open drawers.\n */\nexport const init = (toggleButtonId, distractionSelectors, nopaddingSelectors, closedrawers) => {\n    let button = document.getElementById(toggleButtonId);\n    button.addEventListener('click', () => {\n        const state = Storage.get('block_floatingbutton/distraction-free-button-state');\n        if (state === 'true') {\n            showDistractions();\n            Storage.set('block_floatingbutton/distraction-free-button-state', 'false');\n        } else {\n            hideDistractions(distractionSelectors, nopaddingSelectors, closedrawers);\n            Storage.set('block_floatingbutton/distraction-free-button-state', 'true');\n        }\n    });\n    const state = Storage.get('block_floatingbutton/distraction-free-button-state');\n    if (state === 'true') {\n        hideDistractions(distractionSelectors, nopaddingSelectors, closedrawers);\n    }\n};\n\n/**\n * Hides distractions on the page.\n * @param {Array} distractionSelectors - An array of CSS selectors for distractions to hide.\n * @param {Array} nopaddingSelectors - An array of CSS selectors for elements to remove padding / margin from.\n * @param {boolean} closedrawers - Whether to close open drawers.\n */\nfunction hideDistractions(distractionSelectors, nopaddingSelectors, closedrawers = true) {\n    let drawers = ['left', 'right'];\n    drawers.forEach((s) => {\n        const showdrawer = document.querySelector(`#page.show-drawer-${s}`);\n        if (showdrawer && closedrawers) {\n            const toggles = document.querySelectorAll(`.drawertoggle[data-action=\"closedrawer\"]`);\n            if (toggles) {\n                toggles.forEach((toggle) => toggle.click());\n            } else {\n                distractionSelectors.push(`.drawer-${s}`);\n            }\n        }\n    });\n    distractionSelectors.forEach((s) => {\n        const els = document.querySelectorAll(s);\n        els.forEach((el) => {\n            el.classList.add('block_floatingbutton-hidden');\n        });\n    });\n    nopaddingSelectors.forEach((s) => {\n        const els = document.querySelectorAll(s);\n        els.forEach((el) => {\n            el.classList.add('block_floatingbutton-nopadding');\n        });\n    });\n}\n\n/**\n * Shows distractions on the page.\n */\nfunction showDistractions() {\n    const els = document.querySelectorAll('.block_floatingbutton-hidden, .block_floatingbutton-nopadding');\n    els.forEach((el) => {\n        el.classList.remove('block_floatingbutton-hidden');\n        el.classList.remove('block_floatingbutton-nopadding');\n    });\n}\n"],"names":["hideDistractions","distractionSelectors","nopaddingSelectors","closedrawers","drawers","forEach","s","document","querySelector","toggles","querySelectorAll","toggle","click","push","el","classList","add","toggleButtonId","getElementById","addEventListener","Storage","get","remove","set"],"mappings":";;;;;;;;wBA0DSA,iBAAiBC,qBAAsBC,wBAAoBC,wEAC5DC,QAAU,CAAC,OAAQ,SACvBA,QAAQC,SAASC,OACMC,SAASC,0CAAmCF,KAC7CH,aAAc,OACtBM,QAAUF,SAASG,6DACrBD,QACAA,QAAQJ,SAASM,QAAWA,OAAOC,UAEnCX,qBAAqBY,uBAAgBP,QAIjDL,qBAAqBI,SAASC,IACdC,SAASG,iBAAiBJ,GAClCD,SAASS,KACTA,GAAGC,UAAUC,IAAI,qCAGzBd,mBAAmBG,SAASC,IACZC,SAASG,iBAAiBJ,GAClCD,SAASS,KACTA,GAAGC,UAAUC,IAAI,sDA9CT,CAACC,eAAgBhB,qBAAsBC,mBAAoBC,gBAC9DI,SAASW,eAAeD,gBAC9BE,iBAAiB,SAAS,KAEf,SADAC,QAAQC,IAAI,uDAoDlBd,SAASG,iBAAiB,iEAClCL,SAASS,KACTA,GAAGC,UAAUO,OAAO,+BACpBR,GAAGC,UAAUO,OAAO,qCApDhBF,QAAQG,IAAI,qDAAsD,WAElEvB,iBAAiBC,qBAAsBC,mBAAoBC,cAC3DiB,QAAQG,IAAI,qDAAsD,YAI5D,SADAH,QAAQC,IAAI,uDAEtBrB,iBAAiBC,qBAAsBC,mBAAoBC"}